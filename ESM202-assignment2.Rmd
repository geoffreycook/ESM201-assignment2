---
title: "ESM201-assignment2"
author: "Geoffrey Cook"
date: "3/5/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Reading in data and setting up libraries

library(tidyverse)
grain <- read_csv("grain.csv")
fertilizer <- read_csv("fertilizer.csv")

```

```{r Question 1A: Create a finalized plot (including title and caption) of yield vs. time for each of the grains in the dataset}

grains_yield <- grain %>% 
  select(year, yield, commodity) %>% 
  group_by(commodity)

grains_plot <- ggplot(grains_yield, aes(x = year, y = yield)) + 
  geom_line(aes(color = commodity)) + 
  facet_wrap("commodity") +
  theme_classic() +
  xlab("Year") +
  ylab("Yield (bushels/acre)") +
  ggtitle("Yield of Barley, Corn, Oats, and Sorghum from 1866 to 2018") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous() +
  scale_y_continuous() +
  theme(legend.title=element_blank())
  
grains_plot
```
```{r Question 2A - Create a finalized plot (including title and caption) of fertilizer use vs time for each of the crops in the dataset}

fertilizer_simple <- fertilizer %>% 
  group_by(crop)
  
fertilizer_plot <- ggplot(fertilizer_simple, aes(x = year, y = ppa)) + 
  geom_line(aes(color = fertilizer)) + 
  facet_wrap("crop") +
  theme_classic() +
  xlab("Year") +
  ylab("Fertilizer Application (pounds applied per acre)") +
  ggtitle("Nutrient Loading by Crop") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous() +
  scale_y_continuous() +
  theme(legend.title=element_blank())

fertilizer_plot
```

```{r Question 3A: For corn, create a finalized plot (including title and caption) of yield vs fertilizer ppa, separated by the type of fertilizer. Make the color of the dots correspond to year}

fertilizer_corn <- grain %>% 
  filter(commodity == "Corn") %>% 
  select(year, commodity, yield)


```

